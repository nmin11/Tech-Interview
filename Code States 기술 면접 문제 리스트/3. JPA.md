# JPA

### Q1. 영속성 컨텍스트에 대해 설명해주세요.

<br>

**A.**

영속성 컨텍스트는 한마디로 해서 "Entity를 영구 저장하는 환경"이라고 말할 수 있습니다.  
EntityManager를 이용해서 이 영속성 컨텍스트에 접근할 수 있으며,  
저희가 DB에 데이터를 저장하려 할 때, entityManager.persist를 통해 객체를 저장하는데,  
이는 사실 해당 entity를 DB에 저장하는 것이 아니라, 영속성 컨텍스트에 저장한다고 할 수 있습니다.

<br>

그리고 영속성 컨텍스트를 활용하면 데이터를 조회할 때 DB에서 바로 찾는 것이 아닌, 1차 캐시에서 선행적으로 조회하기 때문에 비즈니스 로직에 조금 더 도움을 줄 수 있습니다.  
또한, 영속 엔티티는 동일한 트랜잭션 내에서 동일한 대상에 대한 조회값은 동일한 값을 가질 수 있도록 도와줍니다.

<br>

이 밖에도 영속성 컨텍스트는 **트랜잭션 지원 쓰기 지연**을 통해 트랜잭션 단위로 한번에 insert 쿼리문을 전달할 수 있도록 해주며, **변경 감지, Dirty Checking**을 이용해서 em.persist나 em.update와 같은 별도의 코드가 없어도 Entity의 변경 사항을 자동으로 감지합니다.

<br>

### Q2. JPA에서 DB를 거치지 않고 저장 된 데이터를 바로 사용하는 상황에 대해 설명해주세요.

<br>

**A.**

네. 그러한 경우에는 영속성 컨텍스트를 활용했다고 볼 수 있습니다.  
저희가 JPA를 활용할 때 흔히 사용하게 되는 entityManager.persist라는 코드를 사용하게 되면,  
이를 바로 DB에 저장하는 것이 아닌, 영속성 컨텍스트에 저장하게 됩니다.  
그리고 하나의 트랜잭션 단위가 끝날 때 영속성 컨텍스트에 대한 flush, 즉 영속성 컨텍스트의 변경 내용을 DB에 반영하는 작업이 일어나게 됩니다.  
이렇게 영속성 컨텍스트에 대한 flush 작업이 일어나기 전, 즉, 하나의 트랜잭션 단위가 끝나기 전에 JPA를 통해서 조회하는 코드를 입력하면 바로 DB를 찾는 것이 아니라 영속성 컨텍스트의 1차 캐시를 활용해서 데이터를 가져올 수 있게 되는 것입니다.
